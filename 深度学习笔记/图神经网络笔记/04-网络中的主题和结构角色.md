# 网络中的主题和结构角色

## 子图及其性质

子图`(subnetworks/subgraph)​`是网络的局部组成，可以用来辨别和区分网络。

![image-20210123161233612](assets/04-%E7%BD%91%E7%BB%9C%E4%B8%AD%E7%9A%84%E4%B8%BB%E9%A2%98%E5%92%8C%E7%BB%93%E6%9E%84%E8%A7%92%E8%89%B2/image-20210123161233612.png)

子图的结构可以有很多种，比如有向图的三节点子图$(n-node subgraphs$，这里$n=3)$就有如下几种形式：

![image-20210123162120177](assets/04-%E7%BD%91%E7%BB%9C%E4%B8%AD%E7%9A%84%E4%B8%BB%E9%A2%98%E5%92%8C%E7%BB%93%E6%9E%84%E8%A7%92%E8%89%B2/image-20210123162120177.png)



对于一个网络来说，可以得到很多个子图，那么什么样的子图是有意义的呢？这就需要一些参数，来衡量子图的重要性。这样，不同的网络就可以表示为以这些子图为基的特征向量。

* 对于每个子图:假设有一个能够对子图“重要性”进行分类的度量。
  * 负值表示表示不足
  * 正值表示过度表示

* 创建一个网络重要性概要:具有所有子图类型值的特征向量

* 接下来:比较不同网络的概况:

  * 调控网络(基因调控)
  * 神经元网络(突触连接)
  * 万维网(网页间超连结)
  * 社交网络(友谊)

  

![image-20210123163348962](assets/04-%E7%BD%91%E7%BB%9C%E4%B8%AD%E7%9A%84%E4%B8%BB%E9%A2%98%E5%92%8C%E7%BB%93%E6%9E%84%E8%A7%92%E8%89%B2/image-20210123163348962.png)

首先看这张图最底下，横坐标，是前面讲到的13种子图的类型，上面的每一行就是不同网络关于这13种子图的一些特征值。可以看到，**同领域的网络，它的特征向量其实是相似的**。比如最后一行的语言网络，对于英语、发育、西班牙语、日语等不同的语言来说，他们尽管语法不尽相同、词语不同，但是它们的特征是**一致的**。

## 主题

网络主题`Network motifs`：反复出现的，重要的相互联系的模式。

如何定义一个网络主题？

1. `pattern `：小结构的子图

2. `recurring`：小结构被发现的次数

3. `Significant`：在随机网络中比预测的多得多的频率

   关键思想：在真实网络中出现的频率要比在随机图中出现的频率要高得多

   ![在这里插入图片描述](assets/04-%E7%BD%91%E7%BB%9C%E4%B8%AD%E7%9A%84%E4%B8%BB%E9%A2%98%E5%92%8C%E7%BB%93%E6%9E%84%E8%A7%92%E8%89%B2/202005181103351.png)

网络主题的作用：

* 帮助我们了解网络是如何工作的
* 帮助我们预测网络在特定情况下的运行和反应

`Motifs`的一些例子：

| Motifs                        | 图例                                                         | 出现的网络                                                   |
| ----------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| `Feed-forward loops` 前馈环路 | ![在这里插入图片描述](assets/04-%E7%BD%91%E7%BB%9C%E4%B8%AD%E7%9A%84%E4%B8%BB%E9%A2%98%E5%92%8C%E7%BB%93%E6%9E%84%E8%A7%92%E8%89%B2/20200518105126518.png) | 这种`Motifs`会在神经元网络中出现，会用来中和“生物噪音（`biological noise`）”。（这应该是属于生物信息学中的相关概念） |
| `Parallel loops `平行环路     | ![在这里插入图片描述](assets/04-%E7%BD%91%E7%BB%9C%E4%B8%AD%E7%9A%84%E4%B8%BB%E9%A2%98%E5%92%8C%E7%BB%93%E6%9E%84%E8%A7%92%E8%89%B2/20200518105613463.png) | 会在食物链网络中出现                                         |
| `Single-input modules`        | ![在这里插入图片描述](assets/04-%E7%BD%91%E7%BB%9C%E4%B8%AD%E7%9A%84%E4%B8%BB%E9%A2%98%E5%92%8C%E7%BB%93%E6%9E%84%E8%A7%92%E8%89%B2/20200518105715975.png) | 在基因控制网络中发现                                         |

与随机网络相比，定义的motifs在真实网络中出现的频率要比在随机图中出现的频率要高得多。怎样去计算这个significance（显著性）呢？设$Z_i$表示`motif `$i$的统计显著性。
$$
Z_i = (N^{real}_i-\bar N_i^{rand}) / std(N_i^{rand})
$$
这里$N_i^{real}$是指在真实网络$G^{real}$中`motif`$i$出现的次数，$N_i^{rand}$是指在随机网络$G^{rand}$中`motif `$i$出现的次数。

那么，网络的`motif `$i$的显著性`(Network Significance Profile, SP)`由标准化后的$Z_i$表示：
$$
SP_i=Z_i/\sqrt{\sum_jZ_j^2}
$$
$SP$更强调不同子图之间的相对显著性，这对于不同规模的网络比较十分有意义，因为一般来说网络规模越大，`Z-scor`e越高，而标准化处理则可以降低尺度效应的影响。

这里有个问题，就是我们怎么得到随机网络$G^{rand}$呢（Configuration model）？并且这个随机网络需$G^{rand}$要和真实网络有相同的 结点，边以及度分布。

**这里介绍两种方式：**

第一种方式，我们可以通过给定的节点数量和节点的度序列（`degree sequence`$  k_1,k_2,\cdots,k_N$）来生成随机图：

![image-20210215200908931](assets/04-%E7%BD%91%E7%BB%9C%E4%B8%AD%E7%9A%84%E4%B8%BB%E9%A2%98%E5%92%8C%E7%BB%93%E6%9E%84%E8%A7%92%E8%89%B2/image-20210215200908931.png)

第二种方式称为`Switching`。

我们从一个给定的图开始（这个图和真实的网络有相同的度），重复以下步骤$ Q \cdot |E|$次，$Q$会取一个较大的值（如100）来使整个过程达到收敛：

![image-20210215201548407](assets/04-%E7%BD%91%E7%BB%9C%E4%B8%AD%E7%9A%84%E4%B8%BB%E9%A2%98%E5%92%8C%E7%BB%93%E6%9E%84%E8%A7%92%E8%89%B2/image-20210215201548407.png)

- 随机选取一条边（例如$A \rightarrow B$，$C \rightarrow D$）
- 将边的终点随机改变。注意的是新生成的边不能构成自环或者双边。

