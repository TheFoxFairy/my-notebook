# 通过图特征空间对比嵌入虚拟网络

## 研究目的

该论文的目的是**研究通用虚拟网络嵌入（VNE）​问题在效率和精度之间的权衡取舍**。为了缩小以前的启发式方案和最佳解决方案之间的差距，并减轻大规模网络VNE​优化方法的不可接受的计算负担，建议使用图特征空间概率进行节点映射，也就是将虚拟结点关基本节点（SN）。

还贡献了一种不精确的算法，该算法将所有SN​投影到**二维特征空间**，以生成更有效的节点映射。

## 术语



## 介绍

**网络虚拟化**是一种有前途的技术，可将传统的网络功能区分开，并通过将ISP​提供的功能划分为基础结构和服务提供商的一部分，来实现Internet服务提供商（ISP）当前封装的Internet体系结构的改进。无论网络虚拟化中使用的业务模型如何，配备虚拟化功能的ISP​都可以抽象为基础架构提供商Inp​的集成，负责部署物理网络资源和虚拟网络提供商（VNP）来从Inp中提供虚拟资源，以便响应用的虚拟网络请求（VNR）。这种灵活的分离方式使用户可以共享虚拟化的网络环境，而忽略了具体的底层实现和资源调度。显然VNP​和Inp之间应该有一个中间模块，用于将请求的网络资源映射到物理网络实体，以便Isp可以充分利用网络资源来提供用户自定义的网络服务。该模块通常被称为虚拟网络嵌入（VNE）。

将当前的VNE方法划分为两类：基于数学优化的表示形式和大多数启发式策略。根据VN是否配置为生命周期，VNE问题可以分为静态或动态问题。

* 基于数学优化的VNE解决方案

基于优化的VNE方案将VNE优化问题描述为一个组合优化问题，然后通过线性规划或整数规划来求解它以发现精确解。

1. Chowdhury等人[3]提出处理节点和链路嵌入阶段之间的相关性。他们将底物网络扩展到一个增强的底物图，在底物图中他们为每一个虚拟结点创建一个元节点，并且每个元节点都连接到集群中的所有底物节点，该群集包含距与该元对应的虚拟结点相距一定距离的底物节点，并且具有无限带宽。然后，将VN嵌入问题通过底物网络扩充转化为一个混合整数程序，并设计了两种在线VN嵌入算法，即确定性**D-ViNE**和随机**R-ViNE**，用于求解具有松弛整数约束的线性规划问题。
2. A-JNLE CG分解方法：以实现一次性节点和连接映射，并引起VN用户之间的竞争。该方案的主要思想是将一个整体的VNE问题分解为一个带基底资源可用性约束的主问题和一个带VN请求嵌入约束的定价问题。A-JNLE CG依赖于列生成技术(CG)，它将附加一个列到主对象的约束矩阵中。此外，可以通过列的迭代生成来处理多个VN请求，减少了列之间的阻塞。此外，通过定期拍卖来分配衬底资源，鼓励多个VNR之间的竞争

* 基于拓扑对应的VNE解决方案

1. 最大程度的利用底物网络中的资源，因此，虚拟节点被贪婪地映射到具有最大数量基板资源的基板节点上，从而使可用资源较少的节点上的资源使用最小化。然后，他们将虚连接映射到基板网络中映射到两个事件节点的基板节点的最短路径。

2. 根据相对重要性对所有的虚拟节点和基础节点进行排名，具有较高排名的虚拟节点将优先映射。

## 虚拟网络嵌入公式

* SN和VNR

SN与VN分别抽象为：
$$
G = (V(G),E(G)),H = (V(H),E(H))
$$
其中,$V()$表示节点集，$E()$表示图中的一组链接。

如果考虑存在$r$种类型的节点或链路约束，其中”约束“是指资源或需求属性，分别取决于所有描述的对象是SN还是VN，然后每个实体$x$应该标识为`r-tuple`$c(x)=(c_1(x),c_2(x),\cdots,c_r(x))$，其中函数$c_i(x)$表示网络实体$x$处约束的大小。

例子，由节点$v1$，$v2$，$v3$和链接$v1v2$，$v1v3$组成的示例虚拟网络，该虚拟网络将嵌入到具有节点$u1$，$u2$，$u3$的基础网络中：

![image-20210216220608109](assets/%E9%80%9A%E8%BF%87%E5%9B%BE%E7%89%B9%E5%BE%81%E7%A9%BA%E9%97%B4%E6%AF%94%E5%AF%B9%E5%B5%8C%E5%85%A5%E8%99%9A%E6%8B%9F%E7%BD%91%E7%BB%9C/image-20210216220608109.png)



* VNE

将$H$嵌入$G$的问题可以建模为查找映射$f：H\rightarrow G$，由节点和链接映射组成，被描述为：

**节点映射**：定义从$V(H)$到$V(G)$的虚拟节点映射，通过$f(v_h)=v_g$将每个虚拟节点$v_h \in V(H)$被嵌入到不同的节点$v_g \in V(G)$。

**链接映射**：虚拟网络中的每个虚链路$u_hv_h\in E(H)$，通过$f (u_hv_h) = p(f (u_h)， f (v_h))$嵌入到衬底路径$p(f (u_h)， f (v_h))$，定义了从$E(H)$到$E(G)$的虚链路映射。

从$H$到$G$的映射$f$必须满足以下约束条件:$\forall h∈\forall (H)$或$h∈E(H)， c(H)≤c(f (H))$。

VNE的目前是设计嵌入f，以便尽可能充分利用SN资源。令z表示优化目标，则可以将VNE问题表征为解决以下优化问题：
$$
\mathop {argmin}_{f}\{z(f)|z(f)=\sum\limits_{l_h\in E(H)}\sum\limits_{l_g\in E(f(l_h))}
z(c(l_g)) + \sum\limits_{v_h\in V(H)}\sum\limits_{v_g\in f(v_h)}z(c(v_g\rightarrow v_h))
\}
$$
以前的论文，使用$f$将虚拟网络$H$嵌入到衬底网络$G$的过程主要由两个优化标准来驱动：收入$r(f)$和嵌入成本$\sigma(f)$，
$$
r(f) = \underbrace{\sum\limits_{v_h\in V(h)}c(v_h)}_{虚拟节点所需的CPU资源} +\underbrace{\sum\limits_{l_h\in E(H)}c(l_h)}_{虚拟链接所需要的的带宽} \\
\sigma(f) = \underbrace{\sum\limits_{v_h\in V(H)}c(v_h)}_{虚拟节点映射到物理结点上，节点所需要的CPU资源} + \underbrace{\sum\limits_{l_h\in E(H)}\sum\limits_{l_g\in E(f(l_h))}c(l_g\rightarrow l_h)}_{虚拟链接映射到物理链接所需要的带宽资源} \\
$$

## 基于特征空间的方案

使用图特征空间技术来解决VNE问题，将特征值应用于组合优化的一种方法是使用特征值将组合优化问题转换为相应的连续优化问题。

> 首先，将VNE问题的优化公式转化为一种图路径距离矩阵的形式，并描述了求解的过程。然后，通过对虚拟网络和基底网络特征空间的对齐来提高解的质量。最后，考虑几种广义距离测度

**A. 将VNE优化公式与基底网络的非加权距离矩阵**

设图为$X$，其邻接矩阵为$A_X$，加权矩阵为$W_X$，度量矩阵为$D_X$，来表示VNE过程。于是，衬底网络图$G = (V(G)， E(G))$及其标准邻接矩阵$A_G$的定义为:
$$
if\ (u_g,v_g) \in E(G)\ then \ A_G(u_g,v_g) = 1,\ else\ A_G(u_g,v_g) = 0.
$$
虚拟网络图$H = (V(H)， E(H))$用其加权邻接矩阵$W_H$表示，实体定义为：
$$
if\ (u_h, v_h) \in E(H )\ then\ W_H (u_h, v_h) = c(u_hv_h),\ else\
W_H (u_h, v_h) = 0.
$$
为了解决VNE优化公式，需要从标准邻接矩阵$A_G$中先验计算全对最短距离$(APSD)$矩阵。用$D_G$表示所有对无权最短路径矩阵。矩阵$D_G$有非零项$D_G(u_g, v_g)$当且仅当存在连通路径$p(u_g, v_g)$使$D_G(u_g, v_g)$等于$u_g$和$v_g$之间的无加权最短路径的长度。因此，矩阵$D_G$的$(u_g, v_g)$项定义为:
$$
D_G(u_g, v_g) = |p(u_g, v_g)|.
$$
于是，可以将公式优化：
$$
\mathop {argmin}_f \{z_l+z_v\}
$$
通过将优化分为两个部分:
$$
z_v = \sum\limits_{v_h\in V(H)}\sum\limits_{v_g\in f(v)}z(c(v_g\rightarrow v_h)) \\
z_l = \sum\limits_{l_h\in E(H)}\sum\limits_{l_g\in E(f(l_h))} z(c(l_g))
$$
由于$v_h$只能映射到一个节点$v_g$, $v_g$必须将最小资源$c(v_h)$分配给虚拟节点$v_h$。因此，有$z_v = \sum\limits_{v_h\in V(H)} c(v_h)$，表示$z_v$与映射$f$无关。因此，优化目标可表示为:
$$
\mathop{argmin}_f\{z(f)|z(f)=\sum\limits_{l_h\in E(H)}\sum\limits_{l_g\in E(f(l_h))}z(c(l_g))\}
$$
如果虚拟链接$l_h = (u_h, v_h)$上的约束$c(l_h)$是由底物路径$p(f (u_h)， f (v_h))$提供的，那么位于$p(f (u_h)， f (v_h))$上的每个链接都会贡献一个资源量$c(l_h)$来占用虚链接$l_h$。这意味着
$$
\begin{align}
z(f) &= \sum\limits_{l_h\in E(H)}\sum\limits_{l_g\in E(f(l_h))}z(c(l_g)) \\
	 &= \sum\limits_{l_h\in E(H)}\sum\limits_{l_g\in E(f(l_h))}c(l_g\rightarrow l_h) \\
	 &= \sum\limits_{l_h\in E(H)}|f(l_h)|c(l_h) \\
	 &= \sum\limits_{l_h\in E(H)}|E(p(f(u_h),f(v_h)))|c(l_h) \\
\end{align}
$$
其中$|f (l_h)|$表示路径$f (l_h)$上的链接数，可进一步表示为：
$$
\begin{align}
z(f) &= (1/2)\sum\limits_{u_h\in V(H)}\sum\limits_{v_h\sim u_h}\underbrace{D_G(f(u_h),f(v_h))}_{虚拟链接所映射的物理链接}\underbrace{c((u_h,v_h))}_{所对应的带宽资源}
\\
&=(1/2)tr(D_G(f(H),f(H))W_H)
\end{align}
$$
其中，$tr(X)$表示矩阵$X$的迹，$D(f (H)，f (H))$是$D_G$的子矩阵，其行、列由$f (H)$索引，定义为$f (H) = \{f (v_h)|v_h\in E(H)\}$。在不失一般性的前提下，我们假设置换矩阵$P$对$D_G$的$m$行$D_G(f (H)，:)$进行置换，但保持其他行不变，并且它对列进行同样的置换。然后，虚拟网络映射$f$可以通过连接到置换矩阵$P$
$$
D_G(f(H),f(H)) = [PD_GP^T]_{1:m}
$$
其中$X_{1:m}$是1到m之间的主子矩阵，结合上面的公式，我们得到一个非常接近于众所周知的二次分配问题(QAP)的优化公式:
$$
\mathop{argmin}_P\{z(P)|z(P)=(1/2)tr([PD_GP^T]_{1:m}W_H)\}
$$
由，`Hoffman-Wielandt`不等式:
$$
tr(Y(PXP^T)) \ge \sum\limits_{1\le i\le n}\lambda_i(Y)\lambda_{n-i+1}(X) \tag{9}
$$
可知，如果[$PD_GP^T]_{_1..m}$的特征值和$W_H$按递增顺序表示为$λ_1(D_G)，…,λ_m (D_G)$和$λ_1(W_H)，…， λ_m(W_H)$，则上述优化可有界为
$$
\sum\limits_{1\le i\le m}\lambda_i(W_H)\lambda_{n-i+1}(D_G) \le tr([PD_GP^T]_{})_{1\cdots m}W_H \tag{8}
$$
对于对称$D_G$和$W_H$，下界可以由$P = Q_GQ_H^T$实现`(见[18,ch. VI, pp. 152-181])`，其中$Q_G$和$Q_H$分别是$D_G$和$W_H$的正交特征向量组成的矩阵。需要以下定理保证存在的模拟$P = Q_GQ_H^T$作为提出的封闭解$VNE$优化模型，并有，当$i\ge j$$X (i:j) = [x_i, x_{i−1}，…,x_j]$，且当$i\le j$，$X (i:j) = [x_i, x_{i+1}，…，x_j]$

定理1:$If\ (λ_i(D_G)， q_i(D_G))(1≤i≤n) and(λ_j (W_H)， q_j (W_H))(1≤j≤m)$是矩阵的特征对$D_G$和$W_H$分别为递增特征值阶VNE优化配方
$$
\mathop{min}_P\{tr([PD_GP^T]_{1\cdots m}W_H)\} \tag{10}
$$
当$P=[Q_G(n:n-m+1)Q^T_H,Q_G(n-m:1)]$，在$Q_G(i:j)(i\ge j)=[q_i(D_G),q_{i-1}(D_G),\cdots,q_{i-j+1}(D_G)]$，$Q_H=[q_1(W_H),q_2(W_H),\cdots,q_m(W_H)]$，到达下界$\sum\limits_{1\le i\le m}\lambda_i(W_H)\lambda_{n-i+1}(D_G)$.

证明:首先，为了应用不等式(9)，我们将优化形式(10)变换为以下阻塞形式:
$$
\begin{align}
tr([PD_GP^T]_{1\cdots m}W_H) &= tr(
\left[\begin{matrix}
(P^TD_GP)_{1\cdots m} & *_{12} \\
*_{21}&*_{22}
\end{matrix}\right]
\left[\begin{matrix}
W_H & 0 \\
0&0
\end{matrix}\right]
) \\
& = 
tr(
P^TD_GP\left[\begin{matrix}
W_H & 0 \\
0&0
\end{matrix}\right]
)
\end{align} \tag{11}
$$
其中“$∗_{ij}$”意味着一个位于位置的矩阵块$(i, j)$而不考虑其实际入口值。将不等式(9)应用于(11)，下界可转化为:
$$
\begin{align}
\mathop{min}_P\{
tr(
P^TD_GP\left[\begin{matrix}
W_H & 0 \\
0&0
\end{matrix}\right]
)
\}\ge \sum\limits_{1\le i\le m}\lambda_i(W_H)\lambda_{n-i+1}(D_G)
\end{align} \tag{12}
$$
实例化排列矩阵$P$为正交矩阵$P=[Q_G(n:n-m+1)Q_H^T，Q_G(n-m+1)]$，进一步的计算表明
$$
\begin{align}
tr(
P^TD_GP\left[\begin{matrix}
W_H & 0 \\
0&0
\end{matrix}\right]
) &= tr(
\left[\begin{matrix}
\Lambda_G(n:n-m+1)\Lambda_G & 0 \\
0&0
\end{matrix}\right]
)
\end{align}
$$
其中，$\Lambda_G(n:n-m+1)=diag(\lambda_n(D_G),\lambda_{n-1}(D_G),\cdots,\lambda_{n-m+1}(D_G))$，且$\Lambda_H=diag(\lambda_1(W_H),\lambda_2(W_H),\cdots,\lambda_m(W_H))$。第二个方程是由$m≤k≤n$时$λ_k(W_H) = 0$得出的。

定理1认为，一旦排列矩阵$P$已知$P = [Q_G(n: n−m + 1)Q_H^T, Q_G(n−m: 1)]$，满足优化式(1)的虚拟网络映射$f$由公式(1)得到：
$$
\forall v_i\in V(H)(1\le i\le m),f_{v_i}=P[u_1,u_2,\cdots,u_n]^T[i]
$$
其中$[u_1, u_2，\cdots， u_n]^T (u_i\in V(G))$是基底网络中与$D_G$同阶的节点向量。

**B. 距离矩阵特征空间的对齐**

对于距离矩阵$D_G$,即使特征$(λ_i(D_G),q_i(D_G))(1\le i\le n)$和$(\lambda_i(W_H),q_i(W_H))(1\le i\le m)$和关联矩阵$P$已经解决,经典的匈牙利法不能直接应用于$P$发现最优映射$f$关于嵌入成本指标,因为该解决方案将不会接受一次$f$违反规定的一对节点通信节点和链接的限制。为了保证定理1导出的解满足节点和链路约束，关联矩阵$P$应该限定节点对应关系，不仅依赖于代价，而且依赖于最小约束。这就要求$D_G$和$W_H$的特征空间进一步对齐。

理想情况下，如果存在一个正实数$θ$，使$λ_i(D_G) = θλ_i(W_H)$对$W_H$的所有特征值$λ_i(W_H)$都成立，则可以认为每个$λ_i(W_H)$都完全对准了$λ_i(D_G)$。在这种情况下，保证了VNE解不违反链路约束。这种理想情况要求$G$的特征值在一个实区间内均匀而密集地分布。在大多数情况下，只要$W_H$的所有不同特征值$λ_i(W_H)$对准$λ_i(D_G)$， VNR的链路和节点需求仍然可以满足。两个$m$维特征值向量$λ(W_H) = [λ_1(W_H),\cdots,λ_m (W_H)]$和$λ(D_G) =(λ_{n-m} (D_G),λ_{n-m + 1} (D_G),\cdots,λ_n(D_G)]$是指移动$λ_i(D_G)$的位置，使$λ(D_G)$和$λ(W_H)$尽可能共线。下面的分析表明,如果$P$导致一个完整的或大约完成对齐,$([P^T D_GP]_{1:m} − W_H )(i, j ) ≥ 0$必须持有,只要$1≤i, j≤m$。考虑到$(λ_i(D_G), q_i(D_G))  $和$(λ_i(D_G), q_i(D_G))$特征值依次递增,即$λ_1(D_G) ≤ λ_2(D_G) ≤ . . . ≤ λ_n(D_G)  $和$λ_1(W_H)≤λ_2(W_H)≤…≤λ_m (W_H)$。通过**Perron-Frobenius**定理([19,p. 167])，非负矩阵的特征值是服从的
$$
|\lambda_i(D_G)|\le\lambda_n(D_G)\ and\ |\lambda_i(W_H)|\le \lambda_m(W_H)
$$
这使得两个特征值向量在**归一化**空间内对齐为$−1≤λ_i(D_G)/λ_n(D_G)≤1$和$−1≤λ_i(W_H)/λ_m(W_H)≤1$。

为了使两个特征值序列对齐，我们选择一个最接近$λ_i(W_H)$的$λ_i(D_G)$作为每个$λ_i(W_H)$的对应。为了保证满足链路约束，选择的$λ_i(D_G)$应满足$\underbrace{λ_i(D_G)≥λ_i(W_H)}_{虚拟网络所需的资源小于等于实际链路的带宽}$，使选择$λ_i(D_G)$的范围缩小到$[λ_i(W_H)， λ_{n−m+i}(D_G)]$区间。在$[λ_i(W_H)， λ_{n−m+i}(D_G)]$中，$λ_i(D_G)$的存在性可由**柯西特征值交错定理(**[19,p. 269])得到，该定理断言对称矩阵$W_H$的主子矩阵的每个特征值$λ_i(W_H)$都有$D_G$的特征值$λ_i(D_G)$的边界，通过不等式:
$$
\lambda_i(D_G)\le \lambda_i(W_H)\le \lambda_{n-m+i}(D_G)
$$
因此，$λ_i(D_G)$就可以位于区间$(λ_i(W_H)/λ_m(W_H)，λ_{n−m+i}(D_G)/ λ_m(W_H))$。取$λ_i(D_G)$，记为:
$$
\lambda_i^*(D_G) = \mathop{argmin}_{\lambda_i(D_G)}\{\lambda_i(D_G)-\theta\lambda_i(W_H)\}
$$
找到$λ^*_i(D_G)$，使$λ_i(W_H) =θλ^∗_i(D_G)$，暗示我们可以重新排列$Q_G$的列，使$D_G$的特征向量$q_i∗(D_G)$对应于$λ^∗_i (D_G)(n−m + 1≤i≤n)$位于第$1$到$m$列中。设$Q_G^∗(m + 1: n)$表示由$Q_G$剩余列组成的子矩阵，即:
$$
Q^*_G(1:m)=[q_1^*(D_G),\cdots,q^*_m(D_G)]
$$
然后,让$Λ^∗_G (1: m) =diag(λ^∗_1 (D_G),λ^∗_2 (D_G),\cdots,λ^∗_m(D_G))$，并配置相关矩阵$P =[Q_G^∗(1:m)Q_H^T,Q_G^∗(m + 1: n)]$将导致:
$$
\begin{align}
[P^TD_GP]_{1:m}&=\left[\begin{matrix}Q_H\Lambda^*_G(1:m)Q^T_H&0\\0&\Lambda^*_G(m:n)\end{matrix}\right]_{1:m} \\
&=Q_H\Lambda^*_G(1:m)Q_H^T
\end{align}
$$
因此，设$R = ([P^TD_GP]_{1:m}−W_H)$，则$R =Q_H(Λ^∗_G (1: m)−Λ_H) Q_H^T≈Q_H(diag((θ−1)λ(W_H)) Q_H^T =(θ−1)W_H$，从而导致$R(u,v)≥0$。**Perron-Frobenius**定理证实了$λ_n$是由不等式限定的
$$
n\ \mathop{min}_i\ a(u_i) = \mathop{min}_i\sum\limits_{j}D_G(u_i,u_j)\le\lambda_n
$$
其中$a(u_i) = (1/n)∑_{u_j} min{c(l_g)|l_g E(p(u_i,u_j))}$表示路径$p(u_i,u_j)$上所有最小约束的平均值，当$u_j$在所有SN节点上时。一般来说，我们必须有一个$a(u_i)\gt 0$由于SN的连通性。这个不等式保证了$λ_n$只要SN的规模(反映在节点和链路的数量上)增长就足够大，这是当前互联网基础设施的一个基本特征。

**C. 特征向量信号校正**

另一方面，我们注意到$D_G$的符号校正也会影响矩阵$p$的计算，需要进行符号校正，以便使特征向量$q_i(D_G)$与特征向量$q_i(W_H)$共线以避免歧义。最直接的方法是取所有$q_i(D_G)$分量的绝对值，这在图匹配中是很常见的操作。然而，我们通过实验观察到，这种方法不适用于VNE目标，可能是由于两个应用领域的细微差异。因此，我们借用了Park等人[20]的另一种符号校正策略，将每个特征向量$q_i(D_G)$与其对应的$q_i(W_H)$进行比较，只要对特征向量$q_i(D_G)$的符号进行校正：
$$
||q_i(D_G)+q_i(W_H)|| \lt ||q_i(D_G)-q_i(W_H)||
$$
这种方法意味着$q_i(D_G)$的多个分量有相反的符号，从而使$q_i(D_G)$和$q_i(W_H$)在特征空间中形成一个较大的角。在这种情况下，$q_i(D_G)$被修正为$−q_i(D_G)$仍然是$D_G$的一个有效特征向量。

**D. 利用广义距离矩阵**

我们应用了全对最短路径距离矩阵$D_G$，记作$PD$，作为求解VNE优化公式的第一步。现在很自然地尝试将$D_G$推广到其他矩阵形式的距离度量，包括欧几里得距离矩阵$(ED)$、热核距离矩阵$(HD)$、最小约束距离矩阵$(MD)$，基于标准邻接矩阵$A_G$。全对最短路径距离矩阵$D_G$与VNE问题很好地匹配，但是利用“funny”的矩阵乘法(在[24]中描述)计算到标准邻接矩阵$A_G$的全对最短路径距离并不方便。采用欧几里得距离矩阵$(ED)$和热核距离矩阵$(HD)$可以避免$PD$的计算。我们的实验表明，这两个距离矩阵产生的结果与$PD$比较，但在更高的计算速度。

*1）欧几里得距离矩阵$(ED)$*：设$D(x)$表示$D$的列向量，该列向量由相关图的节点$x$索引。在大多数情况下，这里描述的距离矩阵$D$可以用特征向量基下的节点坐标在相应特征空间中的欧几里得距离来近似，即$D$中$u$索引的列可以表示为
$$
D(u)=\sum\limits_{1\le i\le |V|}\lambda_iq_i(u)q_i
$$
这意味着列向量$D(u)$在$\{q_i|1≤i≤|V |\}$下，有坐标$[λ_1q_1(u)， λ_2q_2(u)，…， λ_{|V |}q_{|V |}(u)]^T$。这就产生了节点u和v之间的欧氏距离:
$$
d^2_E(u,v) = ||D(u) − D(v)||_2 = \sum\limits_{1≤i≤|V |}λ^2_i (q_i(u) − q_i(v))^2
$$
在对$D_G$和$W_H$进行特征分解时，必须纠正$Q_G$和$Q_H$列中的分量符号，以避免符号歧义。

*2) 热核距离矩阵 $(HD)$*  ：一个尚未考虑到的问题可能会极大地影响嵌入的质量和效率:即嵌入多个动态到达的VNRs的后果。模型和算法还没有解决这个问题。为了实现动态嵌入，自然倾向于在嵌入下一个VNR之前，让SN的距离矩阵更新所有节点对之间的可达路径。不幸的是，对于大多数VNR来说，重新计算SN所有节点对之间的平稳分布最短路径可能是不可接受的。因此，我们考虑替代最短距离矩阵的方法，即借助于其他距离度量来捕获随时间的图的带宽和路径长度信息。热核距离[21]是一种天然的替代方法。热核是热方程的基本解，其中连续拉普拉斯-贝尔特拉米算子作用于流形M上的时变标量函数$h: M\times R^{+}\rightarrow R$，用方程表示热随时间的变化率：
$$
\frac{\partial h(x,t)}{\partial t} = -\Deltah(x,t)(x\in M)
$$
设$L = I−\Delta^{- 1/ 2}D\Delta^ {- 1/2}$是与$D$相关的拉普拉斯矩阵，$\phi_i$是$L$的特征向量，$\Delta$是由定义的$(u, u)$元的对角矩阵$\Delta (u, u) = \sum\limits_{v∼u} D(u, v)$。上述热方程的脉冲响应解$h_t(u, v)$可以通过对离散流形$M$的标准化图**Laplacian** $L$取幂来推导：
$$
h_t(u,v)=e^{-tL}(u,v) = \sum\limits_{1\le i\le |V|}e^{-\lambda_it}\phi_i(u)\phi_i(v)
$$
其指定了信息流过边界的速率$(u, v)$。

为了量化SN中$u$和$v$节点上的最短路径长度，一个合适的选择是将在SN节点上测量的热量嵌入一个r维向量空间，在这个空间中，节点的维数从n减少到r，以提高效率，达到所需的精度水平。设嵌入向量空间有基向量${\phi_i|\phi_i = [\phi_{1i}, \phi_{2i}, . . ., \phi_{ri}]^T}  $。																																																																																									我们可以将式(14)改写为列向量$h_t(v)$的形式，将$v$节点标引为嵌入向量空间基下的坐标表达式，即:
$$
h_t(u)=\sum\limits_{1\le i\le |V|}e^{-\lambda_it}\phi_i\phi_i(v)
$$
前文表明，只要设定向量$[\phi_1,\phi_2,…,\phi_{|V |}]$作为欧几里得空间的基嵌入SN，即列$h_t(V)$对应的SN节点$V$有坐标表达式
$$
h_t(v) = [e^{-\lambda_1t}\phi_1(v),e^{-\lambda_2t}\phi_2(v),\cdots, e^{-\lambda_{|V|}t}\phi_{|V|}(v)]^T
$$
利用节点$u$、$v$的坐标表达式$h_t(u)、h_t(v)$，可以计算出交替邻接距离的欧氏距离$d_{E(u, v)}$，
$$
d^2_{E(u,v)} = ||h_t(u)-h_t(v)||_2 = \sum\limits_{1\le i\le |V|}e^{-2\lambda_it}(\phi_i(u)-\phi_i(v))^2
$$
这样，节点与其相邻节点云之间的距离可以与虚拟节点和基底节点的特征系统对齐相关联。(14)式对$t$积分，可得通勤时间核，可解释为任意长度的随机漫步$(u,v)$之间的转移概率密度:
$$
T(u,v) = \sum\limits_{1\le i}(1/ \lambda_i)\phi_i(u)\phi_i(v)
$$
同时，注意到$L = I−D$，我们可以用$MacLaurin$公式扩展式(14):
$$
h_t = e^{-t(I-D)}=e^{-t}\sum\limits_{k\ge1}(t^k/k!)D^k
$$
距离矩阵$D$通过$D^∗(u, v) = 1/\sqrt{δ(u)δ(v)}$被归一化，其中$δ(u) = \sum\limits_{v∼u} D(u, v)$被称为节点$u$的加权度。

*3) 最小约束距离矩阵 $(MCD)$* ：如前所述，由$PD$、$ED$和$HD$推导出的关联矩阵$P$有时不能保证解满足节点和链路约束，导致接受率不能令人满意。为了避免这个问题，我们可以用新的最小约束矩阵$(MCD)$代替距离矩阵$DG$，它不仅依赖于成本，而且依赖于最小约束，就像我们在我们的仿真中所做的那样。

最小约束距离$(MCD)$矩阵，其条目$D_G(u_g, v_g)$表示节点$u_g$到$v_g$之间最短路径上链路的最小链路容量，用于关联节点和链路的约束。最小约束矩阵仍然记作$D_G$，不会造成混淆，因为它也可以理解为节点间距离矩阵的广义形式。让每个虚拟链路或基板链路持有一个表示其带宽的权值，并考虑两个关联节点的约束，即
$$
If\ u_g \not= v_g\ then\\ \ D_G(u_g, v_g) = min\{c(l_g)|l_g \in
E(p(u_g, v_g))\}\\\ else\ D_G(u_g, v_g) = c(u_g).
$$
**E. 一系列使用距离矩阵的VNE算法**

**1) DMEA-X (VNE算法族)**:上述求解一般VNE问题的过程可以组织为一个算法解族，称为距离矩阵特征空间对齐**DMEA-X**，下面将加以描述。

首先，将**DMEA-PD**算法引入无权全对最短路径距离$(PD)$矩阵优化。其次，**DMEA-ED**和**DMEA-HD**算法考虑了图特征空间中的两种距离形式，即欧几里德距离测度和热核距离测度，对动态导出的VNR进行处理。**DMEA-HD**算法模拟了热扩散过程，对网络资源在时隙中的使用情况进行了估计。最后，考虑到链路和节点约束，提出了比**DMEA-2D**精度更高的**DMEA-MCD**算法，其中距离矩阵的$(u,v)$项是节点对(u,v)之间最短路径上链路的最小约束。

这类算法以符号DMEA-X表示，距离度量X选择为PD、ED、HD和MCD，解释见表4。

![image-20210221150149869](assets/%E9%80%9A%E8%BF%87%E5%9B%BE%E7%89%B9%E5%BE%81%E7%A9%BA%E9%97%B4%E6%AF%94%E5%AF%B9%E5%B5%8C%E5%85%A5%E8%99%9A%E6%8B%9F%E7%BD%91%E7%BB%9C/image-20210221150149869.png)

![image-20210221150210745](assets/%E9%80%9A%E8%BF%87%E5%9B%BE%E7%89%B9%E5%BE%81%E7%A9%BA%E9%97%B4%E6%AF%94%E5%AF%B9%E5%B5%8C%E5%85%A5%E8%99%9A%E6%8B%9F%E7%BD%91%E7%BB%9C/image-20210221150210745.png)

*2)非加权最短路径距离的计算矩阵(PD)*:“有趣的”矩阵乘法(在[24]中描述)生成$D_G$为$D_G = A_G\ min.+ A_G$，其中运算符min.+通过对第i行所有实体和第j列的实体相加来计算最小路径。
$$
D_G(u,v)=\mathop{min}_x\{A_G(u,x)+A_G(x,v)\}
$$
标准邻接矩阵$A_G$的0个表项应初始化为一个用户定义的常数，该常数大于最短路径类型VNE算法使用的预定义参数路径长度值$k$。同时记录$p(u,v)$路径上的节点x跟踪链路，为链路映射阶段做好准备:
$$
E(p(u,v)) = \mathop{argmin}_x\{A_G(u,x)+A_G(x,v)\}
$$
*3) VNE算法DMEA-2D(采用距离矩阵的2D近似)*:就算法计算效率而言，虽然距离矩阵$D_G$的特征分解多项式可解，但计算开销一般为O(n3)。一些研究者发现非负矩阵的**Perron-Frobenius**特征向量特别适用于图中的节点排序问题。这促使我们设计了一种称为DMEA-2D的近似算法来提高VNE的效率，而不显著损失嵌入质量。在DMEA-2D中，我们可以根据距离矩阵$D_G$计算的加权节点度对$VN$和$SN$节点进行排序。这个排序可以用一个相对较低的开销来计算，因为与距离矩阵的最大特征值对应的特征向量有一个封闭形式的解，即**Perron**向量。因此，我们提出了一种不精确但有效的算法，称为**DMEA-2D**，通过将$D_G$的行投影到二维特征空间来实现它。

![image-20210221220033086](assets/%E9%80%9A%E8%BF%87%E5%9B%BE%E7%89%B9%E5%BE%81%E7%A9%BA%E9%97%B4%E6%AF%94%E5%AF%B9%E5%B5%8C%E5%85%A5%E8%99%9A%E6%8B%9F%E7%BD%91%E7%BB%9C/image-20210221220033086.png)

**F.  A Simple Example Illustrating DMEA-MCD**  

获得直觉在前VNE方法面临的挑战我们,我们与三个代表现有的实验VNE提案,GAR-SP, RW-MM-SP DViNE-SP,实现简单的虚拟网络$C_3$和衬底之间嵌入网络$C_4$借助开源框架VNE模拟Alevin 2.2[22]。需要注意的是，Alevin 2.2的网络生成器通常将虚拟网络$C_3$和基底网络$C_4$的节点分别生成为两个有序序列$\{v1, v3,v2\}$和$\{u1, u4,u2,u3\}$，节点标签不是自然顺序的。

正如第1节所讨论的，优化的VNE方法通常在全局范围内搜索和发现最优解。虽然作为[3]中提出的VNE类型的代表，DViNE-SP获得了质量接近最优的最优解。表VIII显示，将58个节点的VN嵌入到100个节点的SN中需要1259.6秒。一般来说，这在实际的VNE部署中是不可接受的。另外两种启发式VNE解GAR-SP[5]和RW-MM-SP[7]通过VN和SN节点之间的近似拓扑对应来执行VNE。GAR-SP将每个VN节点映射为剩余资源最大的SN节点。

为了发现资源最大的节点，该方法将每个VN节点的候选节点初始化为由所有SN节点组成的相同的节点。严格地说，在一定程度上考虑了全局拓扑对应。因此，即使节点映射成功，VNR也会被拒绝，因为可能存在超出嵌入SN链路约束的虚拟链路需求。

不协调节点和链路映射导致的低接受率是我们仿真验证中最主要的挑战。从图2a可以看出，GAR-SP根据VN节点的可用资源，对每个VN节点的候选节点进行排序，选择资源最多的节点，得到用于嵌入$C_3$到$C_4$的节点映射{v1 u2, v2 u3, v3 u4}。计算并表示具有资源指标的候选对象为{(u1, 24073.0)， (u2, 46191.0)，(u3, 29100.0)， (u4, 32661.0)}。然后，以v1v3v2为序的所有虚拟节点都贪婪地将自己的目标节点定位为序列u2u4u3，将序列v1v3v2与序列u2u4u3关联，得到节点映射{v1 u2, v2 u3,v3 u4}。不幸的是，后续的链路映射不能映射到链路v3 v1，因为v3 v1首先映射到最优目标u4 u1 u2，但这违背了约束。随后，唯一可能的备选方案u4 u3 u2也违反了链路u4 u3的约束，因为链路v3 v2在v3 v1之前已经占用了带宽88。

![image-20210221220346684](assets/%E9%80%9A%E8%BF%87%E5%9B%BE%E7%89%B9%E5%BE%81%E7%A9%BA%E9%97%B4%E6%AF%94%E5%AF%B9%E5%B5%8C%E5%85%A5%E8%99%9A%E6%8B%9F%E7%BD%91%E7%BB%9C/image-20210221220346684.png)

RW-MM-SP在VN上建立了一个迭代过程SN以随机漫步收敛到平稳状态，其中$r(G)$和$r(H)$是两个逐步减小排序的实值序列，并根据序列$r(G)$或$r(H)$中的对应值对节点进行排序。
$$
r(G) = \{(u_2,0.0014),(u_3,0.0011),(u_1,0.0011),(u_4,0.0010)\}\\
r(H ) =\{(v_3, 0.0012),(v_2, 0.0011), (v_1, 0.0009)\}
$$
$r(H)$与$r(G)$的对应关系产生$\{v1↔u1, v2↔u3,v3↔u2\}$的节点。同理，RW-MM-SP首先尝试按照最短路径优先原则将链路$v1→v3$映射到$u1→u2, v3→v2$映射到$u2→u3$。但是，两个映射链路的带宽都不能满足虚连接的需求。算法将链路$v1→v3$的映射目标切换到路径$u1→u4→u3→u2$，将链路$v3→v2$的映射目标切换到路径$u2→u1→u4→u3$。第一个选择将$v1→v3$映射到路径$u1→u4→u3→u2$是成功的，因此占用了链路$u1→u4$的带宽$68$。

GAR-SP和RWMM-SP未能将$C_3$嵌入$C_4$的根本原因(部分来自推测，部分已被我们的实验证实)在于他们认为虚拟节点和底物节点之间存在拓扑相关性。前者通过节点的资源级别和连接它的链路来考虑这一因素，后者则将其定义为候选节点和它的邻居计算出的节点的权值。两者都局限于局部特征相关，很少利用节点和链路之间的协调，导致节点映射成功后链路映射失败。
$$
v1 → max \{(u1, 0.9896), (u2, 0.0030), (u3, 0.0074)\};\\
v3 → max \{(u1, 0.7129), (u4, 0.2359), (u2, 0.0511), (u3, 0)\};\\
v2 → max \{(u1, 0.0004), (u4, 0), (u2, 0.0.9972),
(u3, 0.0024)\};
$$
正如前面提到的，当网络扩展时(大小大于VN为58,SN为100)。

我们工作背后的动机是追求效率和精度之间的平衡。嵌入$C_3$到$C_4$的结果表明，我们成功地得到了接近最优解，同时也克服了计算的困难，使运行时间接近近似矩阵特征分解。在上面的例子中，我们的方案对齐最小约束距离矩阵$D_G$的特征空间，得到与dvi - sp质量相同的$C_3 - C_4$嵌入VNE解，如图2c所示，但加速显著，如表III所示，并在后续的仿真中进一步验证。

整个过程如下图所示。对于距离矩阵$D_G\ C_4$，索引矩阵行为节点序，索引矩阵行为节点序$\{u1, u4,u2,u3\}$， $D_G$的形式是:

